



<!DOCTYPE html>
<html lang="en">
<head>

    <link rel="shortcut icon" href="/static/favicon.ico"/>

    <title>
    Matplotlib comprehensive chromosome drawing
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>

    
    

        
        <link rel="stylesheet" href="/static/CACHE/css/2056d73ef46f.css" type="text/css" />

        <script type="text/javascript" src="/static/CACHE/js/acea93bb4f1b.js"></script>

    

    
        
    

    <script type='text/javascript'>
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') +
'//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();
</script>

<script type='text/javascript'>
googletag.cmd.push(function() {
googletag.pubads().collapseEmptyDivs(true);
googletag.defineSlot('/64550467/special_sidebar', [220, 250], 'special_sidebar').addService(googletag.pubads());
googletag.defineSlot('/64550467/Leaderboard', [728, 90], 'div-gpt-ad-1412001329349-0').addService(googletag.pubads());
googletag.defineSlot('/64550467/Sidebar-220x250', [220, 250], 'div-gpt-ad-1412001329349-1').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
googletag.enableServices();
});
</script>


    <script type="application/javascript">
        
            USER_ID = null;
        
        TITLE_SEARCH_URL = "/local/search/title/"
        POST_DISPLAY_URL = "/p/"
    </script>
</head>
<body>

<div class="container" id="content">

    
    
    


<div class="row visible-lg visible-md">
    <div class="col-md-12 text-center" id="topnav">
            
                <div class="col-md-1 ">
                    <a href="/t/Latest/">Latest</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="/t/Open/">Open</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="/t/RNA-Seq/">RNA-Seq</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="/t/ChIP-Seq/">ChIP-Seq</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="/t/SNP/">SNP</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="/t/Assembly/">Assembly</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="/t/Tutorials/">Tutorials</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="/t/Tools/">Tools</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="/t/Jobs/">Jobs</a>
                </div>
            
                <div class="col-md-1 ">
                    <a href="/t/Forum/">Forum</a>
                </div>
            
            <div class="col-md-1 "><a href="/planet/">Planet</a></div>
            <div class="col-md-1 "><a href="/t/">All &raquo;</a></div>
        </ul>
    </div>
</div>

<div class="row visible-sm visible-xs">

    <div class="col-xs-4">
        <div class="btn-group">
            <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
                 View Posts 
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
                
                    <li>
                        <a href="/t/Latest">Latest</a>
                    </li>
                
                    <li>
                        <a href="/t/Open">Open</a>
                    </li>
                
                    <li>
                        <a href="/t/RNA-Seq">RNA-Seq</a>
                    </li>
                
                    <li>
                        <a href="/t/ChIP-Seq">ChIP-Seq</a>
                    </li>
                
                    <li>
                        <a href="/t/SNP">SNP</a>
                    </li>
                
                    <li>
                        <a href="/t/Assembly">Assembly</a>
                    </li>
                
                    <li>
                        <a href="/t/Tutorials">Tutorials</a>
                    </li>
                
                    <li>
                        <a href="/t/Tools">Tools</a>
                    </li>
                
                    <li>
                        <a href="/t/Jobs">Jobs</a>
                    </li>
                
                    <li>
                        <a href="/t/Forum">Forum</a>
                    </li>
                
                <li><a href="/planet/">Planet</a></li>
                <li><a href="/t/">All &raquo;</a></li>
            </ul>
        </div>
    </div>

        <div class="col-xs-4 text-center" style="margin-bottom:5px">
        <a role="button" class="btn btn-primary" href="/">
            <i class="fa fa-star fa-1x"></i> Home </a>
        </a>

    </div>

    <div class="col-xs-4 ">
        <div class="btn-group pull-right">

            
                <div>
                    <a class="btn btn-primary active" role="button" href="/site/login/">
                        <i class="fa fa-user fa-1x"></i> Log In
                    </a>
                </div>
            
        </div>
    </div>
</div>


<div class="row visible-lg visible-md">

    <div class="col-md-12" id="navbar">

        <div class="col-lg-3 visible-lg" id="logo">
            <a href="/"><img src="/static/biostar2.logo.png"></a>
        </div>

        <div class="col-md-3 visible-md text-center">
            <a href="/">
                <a href="/"><img style="width:200px; height: auto;" src="/static/biostar2.logo.png"></a>
            </a>
        </div>

        

            <div class="col-md-9 top text-center">
                 Welcome to Biostar!
                <span class="pull-right">
                    <a href="/info/about/">about</a> &bull; <a href="/info/faq/">faq</a>
                    &bull; <a href="/info/rss/">rss <i class="fa fa-rss"></i></a>
                </span>
            </div>

            <div class="col-md-2 col-md-offset-10 mid ">
                <a href="/user/list/">
                    <div><i class="fa fa-globe"></i>
                    </div>
                    <div>Community</div>
                </a>
            </div>

            <div class="col-md-2 mid ">
                <b><a href="/site/login/">
                    <div><i class="fa fa-user fa-1x"></i></div>
                    <div>Log In</div>
                </a></b>
            </div>

            <div class="col-md-2 mid ">
                <b><a href="/site/login/">
                    <div><i class="fa fa-arrow-circle-up fa-1x"></i></div>
                    <div>Sign Up</div>
                </a></b>
            </div>

            <div class="col-md-2 mid newpost">
                <a href="/p/new/post/" class="navitem ">
                    <div><i class="fa fa-plus-circle fa-1x"></i></div>
                    <div>Add New Post</div>
                </a>
            </div>

        
    </div>
</div>


    

    
    

    
    

    

    <div class="row" itemscope itemtype="http://schema.org/QAPage">

        <div class="col-xs-12 col-md-9">

            <div id="post-details" >
                
                <span itemscope itemtype="http://schema.org/Question">
                    

<div class="post-body Open clearfix">


    
        

    <div align="center" style="padding-bottom:1em">
        <!-- Leaderboard 728x90 -->
        <div id='div-gpt-ad-1412001329349-0' style='width:728px; height:90px;'>
            <script type='text/javascript'>
                googletag.cmd.push(function () {
                    googletag.display('div-gpt-ad-1412001329349-0');
                });
            </script>
        </div>
    </div>



        <div class="title" >Question: <span itemprop="name">Matplotlib comprehensive chromosome drawing</span></div>

    

    <div class="post vote-box visible-lg visible-md" data-post_id="147364">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top"
             data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">0</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top"
             data-type="bookmark" title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="147364"></a>
        
        <div class="content" >

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="/u/2160/"><img src="https://secure.gravatar.com/avatar/0c4ca31d80092c2a3ab52120c7587aef?s=82&d=identicon" alt="gravatar for Sakti"/></a></div>
        <div class="ago">7 months ago by</div>
        <div class="uname">


<a href="/u/2160/">Sakti</a> &bull; <b>250</b></div>
        <div class="loc">United States</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="/u/2160/">Sakti</a> &bull; <b>250</b> wrote:</div>
</div>

            <span itemprop="text"><p>Hello Biostars,</p>

<p>Ryan Dale posted 4 years ago a wonderful answer to the question of how to start your own chromosome plots using Python's Matplotlib <a rel="nofollow" href="https://www.biostars.org/p/9922/">Visualize Chromosome With Python ?</a>.</p>

<p>I am migrating from Perl to Python and have been bashing my head for 3 days trying to add extra lines and gene annotations to Ryan's code, so that the extra gene "tracks" appear below each corresponding chromosome. I'd also like to zoom in to specific regions, and feed that as ranges in the code (i.e. from positions 1-100,000 in each chromosome). So far I have been unsuccessful :( </p>

<p>Anyone with matplotlib experience in here who could give me a hand?</p>

<p>While there are many chromosome plotters out there I would like to learn how to use Matplotlib and Python. I have seen many programmers do rather amazing publication quality figures with it.</p>

<p>Best,</p>

<p>Sakti</p>
</span>


            <div class="clearfix">
                
                    <div class="tags clearfix" style="margin-bottom:0.5em;">
                        
                            <a class="tag" href="/t/plot/">plot</a>
                        
                            <a class="tag" href="/t/matplotlib/">matplotlib</a>
                        
                            <a class="tag" href="/t/chromosome/">chromosome</a>
                        
                            <a class="tag" href="/t/python/">python</a>
                        
                            <a class="tag" href="/t/gene/">gene</a>
                        

                    &bull; 741 views

                    </div>
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="147364" id="C147364">ADD COMMENT</span>

    &bull; <a href="/p/147364/">link</a>
    

    
        
        &bull;

        <div class="btn-group">
            <button type="button" class="btn btn-default btn-xs dropdown-toggle" id="F147364" data-toggle="dropdown">
                
                    Not following
                
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropup" role="menu">

                <li><a href="/local/sub/147364/local/">Follow via messages</a></li>
                <li><a href="/local/sub/147364/email/">Follow via email</a></li>
                <li><a href="/local/sub/147364/nofollow/">Do not follow</a></li>
            </ul>
        </div>
    

    <span class="userlink muted">
            
            modified 7 months ago
            
                by 


<a href="/u/528/">Ryan Dale</a> &diams; <b>3.4k</b>
            
            &bull;
        
        written <span itemprop="dateCreated" content="2015-06-19T13:38:57.465389-05:00">
        7 months ago</span> by 


<a href="/u/2160/">Sakti</a> &bull; <b>250</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                
            </div>
        </div>

    </div>

</div>


                </span>


                
                
                    <span itemscope itemtype="http://schema.org/Answer">
                        

<div class="post-body Open clearfix">


    

    <div class="post vote-box visible-lg visible-md" data-post_id="147637">



        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top"
             data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-2x"></i></div>

        <div class="count" itemprop="voteCount">5</div>

        <div class="vote mark off tip" data-toggle="tooltip" data-placement="top"
             data-type="bookmark" title="Bookmark!">
            <i class="fa fa-book fa-2x"></i>
        </div>

        



    </div>

    <div>

        <a name="147637"></a>
        
        <div class="content" >

            




<div class="col-xs-3 col-md-2 box pull-right text-center visible-lg visible-md">
        <div><a href="/u/528/"><img src="https://secure.gravatar.com/avatar/f09a2bdc56610adbde7b8a860fa4d1f9?s=82&d=identicon" alt="gravatar for Ryan Dale"/></a></div>
        <div class="ago">7 months ago by</div>
        <div class="uname">


<a href="/u/528/">Ryan Dale</a> &diams; <b>3.4k</b></div>
        <div class="loc">Bethesda, MD</div>
</div>

<div class="box text-center visible-sm visible-xs">
    <div class="uname">


<a href="/u/528/">Ryan Dale</a> &diams; <b>3.4k</b> wrote:</div>
</div>

            <span itemprop="text"><p>Upon revisiting this, I've now made it more general. You can now give it any BED file to plot along with the ideograms; here I'm just showing UCSC's knownGenes table from hg38.</p>

<p>To just show a particular region, you could use <a rel="nofollow" href="http://bedtools.readthedocs.org/en/latest/">BEDTools</a> outside of the script or <a rel="nofollow" href="https://pythonhosted.org/pybedtools/">pybedtools</a> inside of it, to subset the input files to your region of interest. You might find <code>pybedtools.BedTool.from_dataframe()</code> and <code>pybedtools.BedTool.to_dataframe() </code>helpful for this. Also note you'll probably have to tweak the chromosome list and figure size appropriately.</p>

<p>I've commented the script to hopefully help you along in learning Python and matplotlib.</p>

<p><script src="https://gist.github.com/daler/c98fc410282d7570efc3.js"></script></p>
</span>


            <div class="clearfix">
                

                
                

<div class="post-action">

    <span class="label label-default add-comment" data-value="147637" id="C147637">ADD COMMENT</span>

    &bull; <a href="/p/147364/#147637">link</a>
    

    

    <span class="userlink muted">
            
            modified 7 months ago
            
            &bull;
        
        written <span itemprop="dateCreated" content="2015-06-22T16:35:26.536272-05:00">
        7 months ago</span> by 


<a href="/u/528/">Ryan Dale</a> &diams; <b>3.4k</b>
    </span>
</div>


            </div>

            
            <div class="comment" itemprop="comment">
                <div class="indent">

<a name="148186"></a>
<div class="entry Open  clearfix">

    <div class="comment vote-box" data-post_id="148186">
        <div class="vote mark off " data-type="vote" title="Upvote!">
            <i class="fa fa-thumbs-o-up fa-1x"></i></div>
        <div class="count"></div>
    </div>

   <p>Beautiful reply, and great code to continue with my Python and matlib trainings. I really appreciate your reply, and hope it's useful for more Biostarters!!!</p>


    
    

<div class="post-action">

    <span class="label label-default add-comment" data-value="148186" id="C148186">ADD REPLY</span>

    &bull; <a href="/p/147364/#148186">link</a>
    

    

    <span class="userlink muted">
            
        written <span itemprop="dateCreated" content="2015-06-25T13:21:38.180972-05:00">
        7 months ago</span> by 


<a href="/u/2160/">Sakti</a> &bull; <b>250</b>
    </span>
</div>


</div>
</div>
            </div>
        </div>

    </div>

</div>


                    </span>
                

                
                <span id="csrf_token"><input type='hidden' name='csrfmiddlewaretoken' value='FpX5aFSKqxsZjP3m6cNGcgjjqZZ8jCet' /></span>

                
                <div>

                    

                    
                    
                        <div class="alert alert-info">
                            Please <a href="/site/login/">log in</a> to add an answer.
                        </div>
                    

                    
                    

                    
                    
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-md-3 sidebar">
            
                <h4>Similar posts &bull; <a href="/local/search/page/">Search &raquo;</a></h4>

                

                <ul class="more-like-this">
                    
                        
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/155186/">How to pull gene identifier from genbank file in Biopython </a>

                                    <div class="peek">Hello!

I am very new to the world of python (or any coding), but have installed biopython which ...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                            

                        
                    
                        
                            
                                <li>
                                    <a href="/p/11023/">Rsamtools-Countoverlaps </a>

                                    <div class="peek">Hi, 
I&#39;m a beginner analyzing genomic data and using R and I have a doubt that I don&#39;t know how t...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/149757/">Plotting &quot;sequence alignments&quot; in python (matplotlib)? </a>

                                    <div class="peek">Hi all,

My boss has given me a task to do the following:

1. Take fasta files, parse them using ...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/45319/">Finding Exon-Intron Boundaries With Orfs : How To Choose The Orfs That Correspond To True Exons ? </a>

                                    <div class="peek">Hi,

I have a set of 2,228 withefish (salmonid) genes assembled from an exon capture chip. These ...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/3695/">Help With Maf&#39;S In Bx-Python </a>

                                    <div class="peek">I&#39;m looking to extract some regions from some maf files, and it seems the way to do it in python ...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/3169/">How To Decide Whether To Keep: Het, U And Extra For Mapping Drosophila Genome </a>

                                    <div class="peek">I am processing Illumina reads from many lanes. We are mainly interested to study SNPs, recombina...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/165446/">How to center SNP position from a tag pair and add flanking sequence using reference genome </a>

                                    <div class="peek">I have a fasta file containing tag pairs (63 identical nucleotides + 1 SNP) like so:


&amp;gt;TP2_qu...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/3425/">1000G And Dbsnp Build 132 In Ucsc Genome Browser? </a>

                                    <div class="peek">Hello ballers,

So correct me if I&#39;m wrong, but as I understand it all of the pilot3 data from 10...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/149275/">Assembling a chromosome for an E. coli strain using contigs/scaffolds from two WGS projects </a>

                                    <div class="peek">Hello everyone,

I&#39;m working on improving the gene coverage for the chromosome of an E. coli stra...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/122452/">vcf to fasta CDS converter  </a>

                                    <div class="peek">I need to create a fasta file that contains only CDS for each sample that I have NGS and genotype...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/1766/">How Many Reads In A Bam File Are Aligned To An Arbitrary Region </a>

                                    <div class="peek">I have BAM files from an Illumina GA experiment. I&#39;d like to know how many of my aligned reads fa...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                        
                        
                    
                        
                            
                                <li>
                                    <a href="/p/112760/">Pangenome visualization: flowerplot? </a>

                                    <div class="peek">I have partitioned the gene complement of 21 strains of a particular species of Strep into core, ...</div>
                                </li>
                            
                        
                        
                    
                        
                            
                        
                        
                    
                </ul>
            
        </div>
    </div>
    



    
    
        <div class="row">
            <div class="col-sm-12 col-md-12">
                <hr>
            </div>
        </div>

        <div class="row toc">

            <div class="col-xs-3 col-xs-offset-1 col-md-2 col-md-offset-3">
                <div class="title">Content</div>
                <ul class="flat">
                    <li><a href="/local/search/page/">Search</a></li>
                    <li><a href="/user/list/">Users</a></li>
                    <li><a href="/t/">Tags</a></li>
                    <li><a href="/b/list/">Badges</a></li>
                </ul>
            </div>

            <div class="col-xs-3 col-md-2">
                <div class="title">Help</div>
                <ul class="flat">
                    <li><a href="/info/about/">About</a></li>
                    <li><a href="/info/faq/">FAQ</a></li>
                </ul>
            </div>

            <div class="col-xs-3 col-md-2 ">
                <div class="title">Access</div>
                <ul class="flat">
                    <li><a href="/info/rss/">RSS</a></li>
                    <li>Stats</li>
                    <li><a href="/info/api/">API</a></li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <hr>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 text-center">
                Use of this site constitutes acceptance of our <a href="/info/policy/">User
                Agreement
                and Privacy
                Policy</a>.
            </div>
            <div class="col-md-12 text-center">
                Powered by <a href="https://github.com/ialbert/biostar-central">Biostar</a>
                version 2.3.0
            </div>
        </div>
    

    
    <div id="traffic">Traffic: 1010 users visited in the last hour</div>

 	<div align="center" style="margin-top:2em">
    <script type="text/javascript"
            src="//rh.revolvermaps.com/0/0/6.js?i=7pci0h9z8v6&amp;m=0&amp;s=300&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=0"
            async="async"></script>
</div>

</div>



    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-101522-12']);
        _gaq.push(['_setDomainName', 'biostars.org']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>

</body>
</html>